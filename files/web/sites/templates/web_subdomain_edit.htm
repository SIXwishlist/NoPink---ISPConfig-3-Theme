<h2><tmpl_var name="list_head_txt"></h2>
<p><tmpl_var name="list_desc_txt"></p>

<div class="container-fluid ">

    <tmpl_if name="domain_option">
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="parent_domain_id">{tmpl_var name='parent_domain_id_txt'}</label>
        <div class="col-md-3">
            <select class="selectize form-control" id="parent_domain_id" name="parent_domain_id" >
                {tmpl_var name='parent_domain_id'}
            </select>
        </div>
    </div>
    </tmpl_if>
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="domain">{tmpl_var name='host_txt'}</label>
        <div class="col-md-6">
            <input class="form-control" name="domain" id="domain" value="{tmpl_var name='domain'}"  type="text"  />
        </div>
    </div>
    <tmpl_if name="domain_option">
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="sel_domain">{tmpl_var name='domain_txt'}</label>
        <div class="col-md-3">
            <select class="selectize form-control" name="sel_domain" id="sel_domain">
                {tmpl_var name='domain_option'}
            </select>
        </div>
    </div>
    <tmpl_else>
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="parent_domain_id">{tmpl_var name='domain_txt'}</label>
        <div class="col-md-3">
            <select class="selectize form-control" id="parent_domain_id" name="parent_domain_id" >
                {tmpl_var name='parent_domain_id'}
            </select>
        </div>
    </div>
    </tmpl_if>
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="redirect_type">{tmpl_var name='redirect_type_txt'}</label>
        <div class="col-md-3">
            <select class="selectize form-control" name="redirect_type" id="redirect_type" >
                {tmpl_var name='redirect_type'}
            </select>
        </div>
    </div>
    <div class="form-group container-fluid">
        <label class="control-label col-md-2" for="redirect_path">{tmpl_var name='redirect_path_txt'}</label>
        <div class="col-md-6">
            <input class="form-control" name="redirect_path" id="redirect_path" value="{tmpl_var name='redirect_path'}"  type="text"  />
        </div>
    </div>
    <div class="form-group container-fluid">
        <label class="col-md-2 control-label" for="active_cb">
            {tmpl_var name='active_txt'}
        </label>
        <div class="col-md-10">
            <div id="active_cb" class=" checkbox check-success">
                {tmpl_var name='active'}
            </div>
        </div>
    </div>
            
    <input type="hidden" name="id" value="{tmpl_var name='id'}">
        
    <div class="container-fluid form-group">
        <div class="col-md-offset-2">
            <button class="positive btn " type="button" value="{tmpl_var name='btn_save_txt'}" onclick="submitForm('pageForm','sites/web_subdomain_edit.php');"><span><span class="glyphicon glyphicon-ok"></span> {tmpl_var name='btn_save_txt'}</span></button>
            <button class="negative btn " type="button" value="{tmpl_var name='btn_cancel_txt'}" onclick="loadContent('sites/web_subdomain_list.php');"><span><span class="glyphicon glyphicon-remove"></span> {tmpl_var name='btn_cancel_txt'}</span></button>
        </div>
    </div>
  
</div>
<script language="JavaScript" type="text/javascript">
    //var webId = jQuery('input[name="id"]').val();
    var webId = jQuery('#parent_domain_id').val();
    var serverId;
    getServerId(webId);
    
    jQuery('#parent_domain_id').change(function(){
        webId = $(this).val();
        getServerId(webId);
    });
	
	if(jQuery('#redirect_type').val() == 'proxy'){
        jQuery('.tabbox_tabs ul li:last').show();
    } else {
        jQuery('.tabbox_tabs ul li:last').hide();
    }
    jQuery('#redirect_type').change(function(){
        if(jQuery(this).val() == 'proxy'){
            jQuery('.tabbox_tabs ul li:last').show();
        } else {
            jQuery('.tabbox_tabs ul li:last').hide();
        }
    });
    
    function getServerId(webId){
        jQuery.getJSON('sites/ajax_get_json.php'+ '?' + Math.round(new Date().getTime()), {web_id : webId, type : "getserverid"}, function(data) {
            serverId = data.serverid;
            adjustForm(serverId);
        });
    }
    
    function adjustForm(serverId){
        jQuery.getJSON('sites/ajax_get_json.php'+ '?' + Math.round(new Date().getTime()), {server_id : serverId, type : "getservertype"}, function(data) {
            var selected = jQuery('#redirect_type').val();
            if(data.servertype == "nginx"){
                jQuery("#redirect_type option[value='R']").attr('disabled','disabled');
                jQuery('#redirect_type option[value="L"]').attr('disabled','disabled');
                jQuery('#redirect_type option[value="R,L"]').attr('disabled','disabled');
                jQuery('#redirect_type option[value="R=301,L"]').attr('disabled','disabled');
                
                jQuery("#redirect_type option[value='R']").hide();
                jQuery('#redirect_type option[value="L"]').hide();
                jQuery('#redirect_type option[value="R,L"]').hide();
                jQuery('#redirect_type option[value="R=301,L"]').hide();
                
                jQuery('#redirect_type option[value="last"]').show();
                jQuery('#redirect_type option[value="break"]').show();
                jQuery('#redirect_type option[value="redirect"]').show();
                jQuery('#redirect_type option[value="permanent"]').show();
				jQuery('#redirect_type option[value="proxy"]').show();
                
                jQuery('#redirect_type option[value="last"]').attr('disabled',false);
                jQuery('#redirect_type option[value="break"]').attr('disabled',false);
                jQuery('#redirect_type option[value="redirect"]').attr('disabled',false);
                jQuery('#redirect_type option[value="permanent"]').attr('disabled',false);
				jQuery('#redirect_type option[value="proxy"]').attr('disabled',false);
                
                if(selected != "no" && selected != "" && selected != "last" && selected != "break" && selected != "redirect" && selected != "permanent" && selected != "proxy") jQuery('#redirect_type option[value="no"]').attr('selected', 'selected');
            } else {
                jQuery('#redirect_type option[value="last"]').attr('disabled','disabled');
                jQuery('#redirect_type option[value="break"]').attr('disabled','disabled');
                jQuery('#redirect_type option[value="redirect"]').attr('disabled','disabled');
                jQuery('#redirect_type option[value="permanent"]').attr('disabled','disabled');
				jQuery('#redirect_type option[value="proxy"]').attr('disabled','disabled');
                
                jQuery('#redirect_type option[value="last"]').hide();
                jQuery('#redirect_type option[value="break"]').hide();
                jQuery('#redirect_type option[value="redirect"]').hide();
                jQuery('#redirect_type option[value="permanent"]').hide();
				jQuery('#redirect_type option[value="proxy"]').hide();
                
                jQuery('#redirect_type option[value="R"]').show();
                jQuery('#redirect_type option[value="L"]').show();
                jQuery('#redirect_type option[value="R,L"]').show();
                jQuery('#redirect_type option[value="R=301,L"]').show();
                
                jQuery('#redirect_type option[value="R"]').attr('disabled',false);
                jQuery('#redirect_type option[value="L"]').attr('disabled',false);
                jQuery('#redirect_type option[value="R,L"]').attr('disabled',false);
                jQuery('#redirect_type option[value="R=301,L"]').attr('disabled',false);
                
                if(selected != "no" && selected != "" && selected != "R" && selected != "L" && selected != "R,L" && selected != "R=301,L") jQuery('#redirect_type option[value="no"]').attr('selected', 'selected');
            }
        });
    }
    
</script>


<!-- switchery script -->
<script>
    var elems = Array.prototype.slice.call(document.querySelectorAll('.switchery'));
    // Success color: #10CFBD
    elems.forEach(function(html) {
        var switchery = new Switchery(html, {color: '#10CFBD'});
    });
</script>